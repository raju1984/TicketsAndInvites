@model  IEnumerable<EventManager1.Areas.Organizer.Models.Salesoverview>
@{
    ViewBag.Title = "Sale";
    Layout = "~/Areas/Organizer/Views/Shared/_organizerLayout.cshtml";
    <style>
        .sidebar-offcanvas {
            max-height: fit-content !important;
        }
        .content-wrapper {
            padding: 4.75rem 2.25rem !important;
        }
        @@media all and (min-width: 320px) and (max-width: 480px) {
            .content-wrapper {
                background: #f2edf3;
                padding: 1.75rem 1.25rem !important;
            }

            .table-bordered {
                border: 1px solid #ebedf2 !important;
            }

            .col-md-4.text-center.borderDottedOnLight {
                margin: 0 20px;
            }
        }
    </style>
}

    <div class="content-wrapper">

        <div class="page-header">
            <h3 class="page-title">
                <span class="page-title-icon bg-gradient-primary text-white mr-2">
                    <i class="mdi mdi-contacts menu-icon"></i>
                </span>
                Sales overview
            </h3>

        </div>
        <div class="row">
            <div class="col-md-12">
                
                <p>
                    Here you can find an overview of sales per each event. This page includes your total
                    revenue
                    and bookings. Additionally, further down the page you can request an account overview
                    and
                    daily/weekly/monthly transactional reports.
                </p>
            </div>
            <div class="col-md-6 filter1">
                <p class="d-inline-block">Event sales</p>
                <p class="d-inline-block float-right">
                    @if (Request.QueryString["type"] == "0")
                    {
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=0 })" >Last Week</a> @:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=1 })" class="text-muted">Last Month</a> @:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=2 })" class="text-muted">Last Year</a>@:&nbsp;
                    }
                    else if (Request.QueryString["type"] == "1")
                    {
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=0 })" class="text-muted">Last Week</a> @:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=1 })">Last Month</a>@:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=2 })" class="text-muted">Last Year</a> @:&nbsp;
                    }
                    else if (Request.QueryString["type"] == "2")
                    {
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=0 })" class="text-muted">Last Week</a> @:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=1 })" class="text-muted">Last Month</a>@:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=2 })">Last Year</a>@:&nbsp;
                    }
                    else if (Request.QueryString["type"] == "3")
                    {
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=0 })" class="text-muted">Last Week</a> @:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=1 })" class="text-muted">Last Month</a>@:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=2 })" class="text-muted">Last Year</a>@:&nbsp;
                    }
                    else
                    {
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=0 })">Last Week</a> @:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=1 })" class="text-muted">Last Month</a>@:&nbsp;
                        <a href="@Url.Action("Promotion","EventPromation",new {area="Organizer",type=2 })" class="text-muted">Last Year</a>@:&nbsp;
                    }

                </p>
            </div>
            <div class="col-md-3">
                <div class="form-group">
                    <label for="" class="d-inline-block">Start Date</label>
                    <input type="date" class="form-control d-inline-block" id="txttodate" onchange="OndateChange()"
                           aria-describedby="emailHelp" placeholder="">
                </div>
            </div>
            <div class="col-md-3">
                <div class="form-group">
                    <label for="" class="d-inline-block">End Date</label>
                    <input type="date" class="form-control d-inline-block" id="txtfromdate" onchange="OndateChange()"
                           aria-describedby="emailHelp" placeholder="">
                </div>
            </div>
        </div>
        
        <div class="row mb-5" style="
    margin-top: 30px;
">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="dtBasicExample" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                    <tr>
                                        <th>Event name</th>
                                        <th>Date</th>
                                        <th>Booked / Total</th>
                                        <th>Event revenue</th>
                                        <th>Transaction costs</th>
                                        <th>Payout</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @{
                                        if (Model != null && Model.Count() > 0)
                                        {
                                            foreach (var item in Model)
                                            {
                                                <tr>
                                                    <td>
                                                        <a href="">
                                                            @item.EventName
                                                        </a>
                                                    </td>
                                                    <td>@item.StartDate</td>
                                                    <td>@item.BookTotal / @item.TotalTicket </td>
                                                    <td>@decimal.Round(Convert.ToDecimal(item.EventRevenue), 2) Gh₵</td>
                                                    <td>@decimal.Round(Convert.ToDecimal( item.TransactionCost),2) Gh₵</td>
                                                    <td>@decimal.Round(Convert.ToDecimal(item.Payout), 2) Gh₵</td>
                                                </tr>
                                            }
                                        }
                                    }

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
<script type="text/javascript">
    function OndateChange() {
        var to = $("#txttodate").val();
        var fromdate = $("#txtfromdate").val();
        if (to && fromdate) {
            var d1 = new Date(to);
            var d2 = new Date(fromdate);
            if(d2>d1)
            {
                window.location = "/Organizer/EventPromation/Promotion?type=3" + "&startdate=" + to +"&enddate=" + fromdate;
            }
        }
    }
</script>