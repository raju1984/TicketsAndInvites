@using EventManager1.Models
@model EventManager1.Models.TicketModelPopup
@{
    Layout = null;
}


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<link rel="icon" href="/images/fav.png" type="image/gif">
<link href="~/css/bootstrap.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;600;700;800;900&display=swap" rel="stylesheet">

<!-- JavaScript -->
<script src="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/alertify.min.js"></script>

<!-- CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.min.css" />
<!-- Default theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.min.css" />
<!-- Semantic UI theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/semantic.min.css" />
<!-- Bootstrap theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.min.css" />

<!--
    RTL version
-->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/alertify.rtl.min.css" />
<!-- Default theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/default.rtl.min.css" />
<!-- Semantic UI theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/semantic.rtl.min.css" />
<!-- Bootstrap theme -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/alertifyjs@1.13.1/build/css/themes/bootstrap.rtl.min.css" />
<style type="text/css">
    @@import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@200;300;400;600;700;800;900&display=swap');

    body {
        background: #f4f4f4;
        margin: auto;
        padding: 0px;
    }

    .footer-inner small {
        font-size: 10px;
        margin-right: 5px;
    }

    .sn-error {
        border-color: #ff0000;
    }

    .event-header {
        position: relative;
        /*background: url(./bg.jpg);*/
        background-image: url('../../images/bg.jpg');
        min-height: 350px;
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        text-align: center;
        display: flex;
        align-items: center;
    }

        .event-header .logo {
            position: absolute;
            left: 5%;
            top: 5%;
        }

            .event-header .logo img {
                height: 60px;
            }

        .event-header h1 {
            margin: 0px;
            text-align: center;
            color: #FFF;
            text-transform: uppercase;
            font-size: 50px;
            letter-spacing: 3px;
        }

        .event-header .text hr {
            width: 100%;
        }

        .event-header .text {
            margin: auto;
            display: inline-flex;
            flex-direction: column;
            justify-content: stretch;
            align-items: center;
        }

    h1.title {
        letter-spacing: 1px;
        font-weight: 400;
        background: #FA8731;
        background: linear-gradient(to right, #FA8731 0%, #FAA903 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .form-ui {
        font-family: 'Montserrat', sans-serif !important;
        background: #FFF;
        box-shadow: 0px 0px 21px 0px rgb(0 0 0 / 17%);
        padding: 25px;
        width: 750px;
        margin: -50px auto 0;
        border-radius: 20px;
        margin-bottom: 50px;
        max-width: 100%;
        position: relative;
        z-index: 99;
    }

        .form-ui form {
        }

        .form-ui label {
            color: #37365d;
            font-weight: 700;
            text-transform: uppercase;
            margin-right: 10px;
            margin-bottom: 0px;
        }

    .ml-auto {
        display: flex;
        margin-left: auto;
    }

    .form-box.qty-box {
        margin: 0 20px 0 10px;
        display: flex;
        align-items: center;
    }



    .qty-box input {
        margin: 0 10px;
        height: 45px;
        font-family: 'Montserrat', sans-serif;
        text-align: center;
        width: 50px;
        border: 0px;
        font-size: 20px;
        padding: 0px 5px;
        border-radius: 30px;
        font-weight: 800;
        color: #FFF;
        background: rgb(250, 137, 46);
        outline: none !important;
        box-shadow: 0px 10px 11px 0px rgba(0, 0, 0, 0.12);
        background: radial-gradient(circle, rgba(250, 137, 46, 1) 0%, rgba(249, 151, 26, 1) 50%, rgba(250, 137, 46, 1) 100%);
    }

    .form-box select option {
        color: #37365d;
        font-weight: 600;
    }

    .form-box select {
        position: relative;
        width: 400px;
        min-width: 100%;
        height: 45px;
        letter-spacing: 1px;
        font-family: 'Montserrat', sans-serif;
        text-align: center;
        border: 0px;
        font-size: 16px;
        padding: 0px;
        border-radius: 30px;
        font-weight: 600;
        color: #FFF;
        background: rgb(250, 137, 46);
        outline: none !important;
        -moz-appearance: none;
        /* Firefox */
        -webkit-appearance: none;
        /* Safari and Chrome */
        appearance: none;
        box-shadow: 0px 10px 11px 0px rgba(0, 0, 0, 0.12);
        background: radial-gradient(circle, rgba(250, 137, 46, 1) 0%, rgba(249, 151, 26, 1) 50%, rgba(250, 137, 46, 1) 100%);
    }

    .select-arrow {
        position: relative;
    }

        .select-arrow:after {
            content: '';
            /*background-image: url(./arrow.png);*/
            background-image: url('../../images/arrow.png');
            position: absolute;
            width: 22px;
            height: 20px;
            right: 14px;
            top: 16px;
            background-repeat: no-repeat;
            background-size: contain;
        }

    .btn-ui {
        height: 45px;
        background: #bb247e;
        font-family: 'Montserrat', sans-serif;
        color: #FFF;
        border: 0px;
        border-radius: 11px;
        padding: 10px 15px;
        font-weight: 600;
        text-transform: uppercase;
    }

    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;
    }

    .table-ui {
        width: 100%;
        margin: 40px 0 30px;
    }

        .table-ui .remove {
            font-family: 'Montserrat', sans-serif !important;
            background: #bd247f;
            border: 0px;
            color: #FFF;
            border-radius: 4px;
            padding: 3px 10px;
            font-weight: 600;
            letter-spacing: 1px;
        }

    .color-box {
        font-family: 'Montserrat', sans-serif !important;
        background: #37365d;
        color: #FFF;
        font-size: 25px;
        font-weight: 800;
        width: 50px;
        display: block;
        text-align: center;
        padding: 0px 5px;
        border-radius: 60px;
        height: 45px;
        line-height: 45px;
        box-shadow: 0px 6px 5px 0px rgb(0 0 0 / 5%);
    }

    .d-flex {
        display: flex;
        align-items: center;
    }

    .option {
        color: #37365d;
        font-size: 25px;
        margin: 0px;
        text-transform: uppercase;
    }

    .table-ui .d-flex {
        margin-bottom: 25px;
    }

    .option span {
        width: 25px;
        height: 20px;
        /*background: #37365d;*/
        display: inline-block;
        border-radius: 5px;
        margin-left: 20px;
    }

    .amount {
        margin-left: 25px;
        width: 100%;
        padding: 0px 15px;
        font-family: 'Montserrat', sans-serif !important;
    }

    .total {
        max-width: 80%;
        margin: auto;
        display: flex;
        align-items: center;
    }

        .total h1 {
            color: #37365d;
            text-transform: uppercase;
            font-weight: 800;
        }

    .total-amount {
        font-family: 'Montserrat', sans-serif !important;
        font-size: 50px;
        font-weight: 800;
        color: #bd247f;
        margin: 0;
    }

        .total-amount span {
            font-size: 15px;
            color: #37365d;
            font-weight: 600;
        }

    span.line {
        display: block;
        height: 4px;
        background: #37365d;
        width: 40%;
        border-radius: 50px;
        margin: auto;
    }

    button {
        cursor: pointer;
    }

    .protopay {
        width: 80%;
        margin: 10px 10% 0px;
        background: #bd247f;
        color: #FFF;
        font-family: 'Montserrat', sans-serif;
        text-transform: uppercase;
        font-size: 20px;
        letter-spacing: 1px;
        font-weight: 800;
        border: 0px;
        padding: 5px 10px;
        border-radius: 50px;
        position: relative;
        bottom: -50px;
        box-shadow: 0px 10px 11px 0px rgba(0, 0, 0, 0.12);
    }

    .event-footer {
        margin-top: 15%;
    }

    .footer-inner {
        padding: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        color: #37365d;
    }

    .plus,
    .min {
        cursor: pointer;
        font-size: 30px;
        font-weight: 800;
        color: #37365d;
    }

    .bottom-box {
        width: 80%;
        margin: 50px auto 0;
        display: flex;
        align-items: center;
        border: 1px solid #35365b;
        padding: 15px 20px;
        border-radius: 30px;
    }

        .bottom-box p {
            color: #37365d;
            font-weight: 700;
            text-transform: uppercase;
            margin-right: 10px;
            font-size: 15px;
            letter-spacing: 0.5px;
            margin-bottom: 0;
        }

    .form-ui .form-control {
        margin-bottom: 20px;
        margin-top: 5px;
    }

    .form-check {
        margin-top: 20px;
    }

    label.form-check-label {
        text-transform: inherit;
        font-size: 13px;
        letter-spacing: 0.3px;
    }

    .form-check-input {
        width: 15px;
        height: 15px;
        top: -4px;
    }

    .selec-label {
        margin-bottom: 10px
    }

    .error-box p {
        color: #f00;
        font-size: 14px;
        font-weight: 600;
        text-align: center;
    }

    .m10 {
        margin: 0px 10px;
    }

    .egift {
        border: 1px dashed #a1a1a1;
        padding: 15px;
        margin-top: 30px;
        margin-bottom: 20px;
        border-radius: 15px;
    }

        .egift .input-group {
            margin-top: 15px;
        }

        .egift .form-control {
            margin: 0px;
        }

        .egift .input-group-text {
            line-height: normal;
            padding: 0px;
        }

            .egift .input-group-text input[type="button"] {
                border: 0px;
                font-size: 14px;
                font-weight: 600;
                color: #37365d;
                padding: 12px 20px;
            }

    @@media (max-width: 768px) {
        .selec-ticket-div .form-box select {
            width: auto
        }

        .select-arrow {
            width: 100%;
        }
    }

    @@media (max-width: 600px) {
        .selec-ticket-div .form-box select {
            width: 100%;
            padding: 0 20px;
        }

        .selec-ticket-div .d-flex {
            flex-wrap: wrap;
        }

        .selec-ticket-div .ml-auto {
            margin-left: 0px !important;
            margin-top: 30px;
            width: 100%;
        }

        .table-ui .d-flex {
            flex-direction: column;
            text-align: center;
            border: 1px dashed #a1a1a1;
            border-radius: 8px;
            padding: 15px;
        }

            .table-ui .d-flex .ml-auto {
                margin-left: 0px !important;
            }

        .option span {
            display: none
        }

        .option {
            font-size: 16px;
            font-weight: 600;
            margin: 20px 0;
        }
    }

    .color-box.amount .Currency {
        font-size: 13px;
        font-weight: 600;
        position: relative;
        top: -13px;
        left: -2px;
    }

    .event-header h1{
        font-family: 'Montserrat', sans-serif !important;
    }
    @@media (max-width: 599px) {
        .event-header {
            min-height: auto;
            padding: 40px 0 80px;
        }
            .event-header .text hr {
                margin: 5px 0;
            }
        h1.title {
       
            font-size: 20px;
            font-weight: 600;
        }
        .event-header h1 {
            font-size: 20px;
        }
        .form-ui {
            max-width: 96%;
            padding: 2px 20px 30px;
            border-radius: 5px;
        }
        .total h1, .total-amount {
            font-size: 20px;
        }
        .protopay {
            font-size: 16px;
            width: 100%;
            margin: 0px;
            bottom: -30px;
            padding: 15px 5px;
        }
    }
</style>

<div class="event-header">
    <input type="hidden" id="TicketId" value="@Model.EventId" />
    <input type="hidden" style="margin-left: 50px;" id="hfeventId" name="hfeventid" value="@ViewBag.evId" />
    <input type="hidden" style="margin-left: 50px;" id="hfeventType" name="hfeventType" value="@ViewBag.eventType " />
    <input type="hidden" id="logo" name="logo" value="@ViewBag.logo " />
    <input type="hidden" style="margin-left: 50px;" id="UserID" name="UserID" value="@ViewBag.UserID" />

    <div class="logo">
        @*<img src="~/images/Gold-Badge.png" />*@
        <img src="@ViewBag.logo" />
    </div>
    <div class="text">
        <h1 class="title">@Model.Eventname</h1>
        <hr>
        <h1>Get Your Ticket</h1>
    </div>
</div>
<div class="event-body">
    <div class="form-ui">
        <div class="error-box">
            <p>
            </p>
        </div>
        @if (Model.CreatedOnWebsite == 2)
        {
            if (Model.Tickest != null && Model.Tickest.Count > 0)
            {<form>
                    <div class="row">
                        <div class="col-sm-6">
                            <label>First Name</label>
                            <input type="text" id="FirstName" class="form-control sn-required" required />
                        </div>
                        <div class="col-sm-6">
                            <label>Last Name</label>
                            <input type="text" id="LastName" class="form-control sn-required" required />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <label>Email Address</label>
                            <input type="text" id="EmailAddress" class="form-control sn-required" required />
                        </div>
                        <div class="col-sm-6">
                            <label>Mobile Number</label>
                            <input type="number" id="MobileNumber" class="form-control sn-required" required />
                        </div>
                    </div>
                    <div class="selec-ticket-div">

                        <label class="selec-label">Select Ticket</label>
                        <div class="d-flex">
                            <div class="form-box select-arrow">

                                <select id="TicketDropDown">
                                    <option value="">Select Tickets</option>
                                    @foreach (var item in Model.Tickest)
                                    {
                                        if (item.IsEnable == true)
                                        {
                                            string Currency = "";
                                            if (item.PaymentType == (int)PaymentCurrency.Ghanna)
                                            {
                                                Currency = "GH₵";
                                            }
                                            else if (item.PaymentType == (int)PaymentCurrency.Usd)
                                            {
                                                Currency = "$";
                                            }
                                            else if (item.PaymentType == (int)PaymentCurrency.Pound)
                                            {
                                                Currency = "£";
                                            }
                                            else if (item.PaymentType == (int)PaymentCurrency.Euero)
                                            {
                                                Currency = "€";

                                            }

                                            <option value="@item.TicketId">@Currency @item.Price ~ @item.TicketName</option>
                                        }
                                    }
                                </select>

                            </div>


                            <div class="ml-auto">
                                <div class="form-box qty-box">
                                    <label>Qty</label>
                                    <span class="min button" onclick="DecreaseTicketCount();">-</span>
                                    <input type="number" disabled name="ticketadded" id="ticketadded" maxlength="12" value="0" />
                                    <span class="plus button" onclick="IncreaseTicketCount();">+</span>

                                </div>
                                <button type="button" id="AddTicket" class="btn-ui">Add</button>
                            </div>
                        </div>
                    </div>


                </form>


            }

        }
        else
        {
            if (Model.Tickest != null && Model.Tickest.Count > 0)
            {

                <form>
                    <div class="row">
                        <div class="col-sm-6">
                            <label>First Name</label>
                            <input type="text" id="FirstName" class="form-control sn-required" required />
                        </div>
                        <div class="col-sm-6">
                            <label>Last Name</label>
                            <input type="text" id="LastName" class="form-control sn-required" required />
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-sm-6">
                            <label>Email Address</label>
                            <input type="email" id="EmailAddress" class="form-control sn-required" required />
                        </div>
                        <div class="col-sm-6">
                            <label>Mobile Number</label>
                            <input type="number" id="MobileNumber" class="form-control sn-required" required />
                        </div>
                    </div>
                    <div class="selec-ticket-div">

                        <label class="selec-label">Select Ticket</label>
                        <div class="d-flex">
                            <div class="form-box select-arrow">

                                <select id="TicketDropDown">
                                    <option value="">Select Tickets</option>
                                    @foreach (var item in Model.Tickest)
                                    {
                                        if (@item.Price > 0)
                                        {
                                            string Currency = "";
                                            if (item.PaymentType == (int)PaymentCurrency.Ghanna)
                                            {
                                                Currency = "GH₵";
                                            }
                                            else if (item.PaymentType == (int)PaymentCurrency.Usd)
                                            {
                                                Currency = "$";
                                            }
                                            else if (item.PaymentType == (int)PaymentCurrency.Pound)
                                            {
                                                Currency = "£";
                                            }
                                            else if (item.PaymentType == (int)PaymentCurrency.Euero)
                                            {
                                                Currency = "€";

                                            }

                                            <option value="@item.TicketId">@Currency @item.Price ~ @item.TicketName</option>
                                        }
                                        else
                                        {
                                            <option value="@item.TicketId">Free Pass ~ @item.TicketName</option>
                                        }
                                    }
                                </select>

                            </div>


                            <div class="ml-auto">
                                <div class="form-box qty-box">
                                    <label>Qty</label>
                                    <span class="min button" onclick="DecreaseTicketCount();">-</span>
                                    <input type="number" disabled name="ticketadded" id="ticketadded" maxlength="12" value="1" min="1" />
                                    <span class="plus button" onclick="IncreaseTicketCount();">+</span>
                                </div>
                                <button type="button" id="AddTicket" class="btn-ui">Add</button>
                            </div>
                        </div>
                    </div>

                </form>
            }
        }
        <div class="">
            <div id="label1">

            </div>


            <div id="label">

            </div>

        </div>
        <div>
            <input type="hidden" id="UserId" />
        </div>

        <div class="total" id="hide">
            <h1>Total</h1>
            <span class="line"></span>
            <div class="ml-auto total-amount" id="total-amount"><span class="Currency"></span>0</div>
        </div>

        <div class="form-check">
            <input class="form-check-input sn-required" type="checkbox" value="" id="flexCheckDefault">
            <label class="form-check-label" for="flexCheckDefault">
                I confirm my E ticket should be delivered to the contact details provided.
            </label>
        </div>

        <form @*class="row" action="~/ev/PaymentMode" method="post" onsubmit="Loader(true)"*@ style="display:none" id="fdiscount">
            <input type="hidden" style="margin-left: 50px;" id="hfeventId" name="hfeventid" value="@ViewBag.evId" />
            <input type="hidden" style="margin-left: 50px;" id="UserID" name="UserID" value="@ViewBag.UserID" />
            <button type="button" id="btnSubmit" class="protopay">Proceed to grab ticket</button>
        </form>
    </div>
</div>
<div class="event-footer">
    <div class="footer-inner">
        <small><b>Powered By</b></small>
        @*<img src="~/images/footer-logo.jpg" />*@

        <img src="~/images/footer-logo.jpeg" height="45" />
    </div>
</div>

<script src="https://js.paystack.co/v1/inline.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script>

    function IncreaseTicketCount() {

            $('#ticketadded').val(parseInt($('#ticketadded').val()) + 1);

    }

    function DecreaseTicketCount() {

        if (parseInt($('#ticketadded').val()) == 1) {
            $('.error-box p').text('Can not reduce quantity less then 1');
           // alertify.alert('Can not reduce quantity less then 1');
        }
        else {
            $('#ticketadded').val(parseInt($('#ticketadded').val()) - 1);
        }

    }

    function CheckTicket() {
        console.log($('#TicketId').val());
        var TicketId = parseInt($('#TicketDropDown').val());
        var SelectedTickets = $('#ticketadded').val();
        EventId = $('#EventID').val();
        debugger;
        $.ajax({
            url: "/ev/CheckTicketBalance?EventId=" + EventId + "&TicketId=" + TicketId + "&SelectedTickets=" + SelectedTickets,
            type: "POST",
            dataType: "json",
            contentType: "application/json; charset=utf-8",
            //data: JSON.stringify({ name: 'value1', email: 'value2' }),
            success: function (result) {
                // when call is sucessfull'
                console.log(result);
                if (result != null) {


                } else {

                    $('#MobileNumber').removeAttr('readonly');

                }
            },
            error: function (err) {
                // check the err for error details
            }
        }); // ajax call closing
    }

    function AddMinusTicket(type, ticketId, AvQty, Price, paymentType) {
        debugger;
        var AddedQty = $("#spnsingle" + ticketId).text();
        var AvQty = parseInt(AvQty);

        if (type == "add") {
            AddedQty = parseInt(AddedQty) + 1;
            var etype = $('#eventType').val();
            if (AddedQty > AvQty) {
                if (etype == "1") {
                    alertify.alert('You can only purchase a maximum of one(1) for each ticket type.');
                } else {
                    alertify.alert('Only ' + AvQty + ' Ticktes Available!');
                }

            }
            else {
                if (Price && parseFloat(Price) > 0) {
                    totalamount = totalamount + parseFloat(Price);
                }
                totalitem = totalitem + 1;
                AddTickeToCart(ticketId, 1, Price, paymentType);
                $("#spnsingle" + ticketId).text(AddedQty);
            }
        }
        else {
            if (parseInt(AddedQty) > 0) {
                AddedQty = AddedQty - 1;
                totalitem = totalitem - 1;
                if (Price && parseFloat(Price) > 0) {
                    totalamount = totalamount - parseFloat(Price);
                    AddTickeToCart(ticketId, -1, Price, paymentType);
                }
                $("#spnsingle" + ticketId).text(AddedQty);
            }
        }
            currency = "";
        if (paymentType == 1) {
            currency = 'Gh₵';
        } else if (paymentType == 2) {
            currency = '$';
        } else if (paymentType == 3) {
            currency = '£';

        } else if (paymentType == 4) {
            currency = '€';

        }
        $("#spnTotalItem").text(totalitem);
        $("#spntotakamountheder").text(totalamount);
        $("#pfootertotal").text(totalamount);
        $('#lbltotal').text(totalamount + currency);

    }
    function AddTickeToCart() {
        var evid = parseInt('@ViewBag.evId');
        var eventype = parseInt('@ViewBag.eventType');
        var TicketId = parseInt($('#TicketDropDown').val());
        var Qty = parseInt($('#ticketadded').val());
        var price = $('#Price').val();
        var Paymentype = $('#Paymentype').val();
        var TicketName = $('#TktName').val();
        var TotalTicket = parseInt($('#TicketBalance').val());
        debugger
        $.ajax({
            type: 'POST',
            url: '@Url.Action("AddTicketToSession", "Home", new { area = "" })',
            data: { TicketId: TicketId, Qty: Qty, Price: price, paymentType: Paymentype, TicketName: TicketName, TotalTicket: TotalTicket, evid: evid, eventype: eventype },
            dataType: "json",
            success: function (resp) {
                debugger;
                //console.log('coming' + resp);
                if (resp != null) {
                    LoadCart(evid, resp,"");
                } else {
                    LoadCart(evid, "","");
                }
                // console.log(resp);
                //alertify.alert(resp);

            },
            error: function (error) {

                //alertify.alert(error);
            }
        });
    }

    function validateTerms() {
        debugger;
        var term = $('#terms');
        if ($(term).is(":checked")) {
            $('#PaymentArea').empty();
            $('#PaymentArea').append('<input type="submit" class="btn btn-primary smal-btn2" value="Proceed to Pay" id="expressPay" style="width: 83%;background: #fb0000 !important;color: #fff !important;width: 100%;padding: 10px 0; margin-left: -7px;" />');
        }
        else {
            $('#PaymentArea').empty();
            $('#PaymentArea').append('<input type="button" class="btn btn-primary smal-btn2 paybtn" value="Proceed to Pay" id="expressPay" style="width: 83%;background: #fb0000 !important;color: #fff !important;width: 100%;padding: 10px 0; margin-left: -7px;" />');
        }

    }

    $(document).on("click", ".paybtn", function () {
        if (document.getElementById('lbltotal').innerHTML == 0 || document.getElementById('lbltotal').innerHTML == "") {

            alertify.alert('Please select the tickets!');
            return
        }
        //console.log("Log :" + document.getElementById('lbltotal').innerHTML);
        alertify.alert('Please accept terms & Conditions to proceed..');
    });


    $('#TicketDropDown').change(function () {
        debugger;
        var EventId = $('#TicketId').val();
        var TicketId = $(this).val();
      //  console.log('comig');
        //$('#ticketadded').val(1);
        Loader(true);
        //console.log('EvevntId:' + EventId + 'TicketId' + TicketId);
        $.ajax({
            url: '/ev/GetTicketDetails?EventId=' + EventId + "&TicketId=" + TicketId,
            contentType: 'application/html; charset=utf-8',
            type: 'GET',
            dataType: 'html',
            success: function (result) {
                Loader(false);

                $('#label').html(result);

            },
            error: function (xhr, status) {
                Loader(false);
                alert(status);
            }
        })
    });
    function EmailValidation(EmailAddress) {
        var email = EmailAddress;
        var regex = /^([a-zA-Z0-9_.+-])+\@@(([a-zA-Z0-9-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if (regex.test(email)) {
            return true;
        } else {
            $('.error-box p').text('Invalid Email');

            $("#EmailAddress").val("");

            return false;
        }
    }
    $('#EmailAddress').change(function () {
        var Result = false;
        EmailAddress = $(this).val();
        Result  = EmailValidation(EmailAddress);

        if (Result) {
            $.ajax({
                url: "/ev/CheckEmailExists?EmailId=" + EmailAddress,
                type: "POST",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                //data: JSON.stringify({ name: 'value1', email: 'value2' }),
                success: function (result) {
                    // when call is sucessfull'
                    console.log(result.Id);
                    if (result.Id > 0) {
                        $('#MobileNumber').val(result.PhoneNo);
                        $('#UserId').val(result.Id);

                    } else {

                        $('#MobileNumber').removeAttr('readonly');

                    }
                },
                error: function (err) {
                    // check the err for error details
                }
            }); // ajax call closing
        }
    });

    $('#AddTicket').click(function () {
        debugger;
        var ticketId = $('#TicketDropDown').val();
        console.log(ticketId);
        if (ticketId == "") {
            $('.error-box p').text('Please select the ticket');
            return;
        } else {
            $('.error-box p').text('');
        }
        AddTickeToCart();
    });

    function LoadCart(evID,resp, coupan) {
        Loader(true);
        //console.log('Resp:'+resp);

        $.ajax({
            url: '/ev/AddTickets?evid=' + evID + '&Coupon=' + coupan,
            contentType: 'application/html; charset=utf-8',
            type: 'GET',
            dataType: 'html',
            success: function (result) {
                Loader(false);
                $('#label1').html(result);
                if (resp != null) {
                    $('.error-box p').text(resp);
                }
            },
            error: function (xhr, status) {
                Loader(false);
                alert(status);
            }
        });
    }

    function reload() {
        console.log('coming');
        $.ajax({
            url: '/ev/AddTickets',
            contentType: 'application/html; charset=utf-8',
            type: 'GET',
            dataType: 'html',
            success: function (result) {
                Loader(false);

                $('#label1').html(result);

            },
            error: function (xhr, status) {
                Loader(false);
                alert(status);
            }
        })
    }

    function AddMinusTicketNew(type, ticketId, AvQty, Price, paymentType, TicketName) {
        debugger;
       // TicketName = $('#TktName').text();
        TicketName = $('#TktName').val();
        if (type != undefined && type != "" && ticketId != undefined && ticketId != "" && AvQty != undefined && AvQty != "NaN" && Price != undefined && paymentType != undefined)
        {

            if (type == "add") {

                    if (parseInt(AvQty) > 0) {
                        var ticketadded = parseInt($('#ticketadded').val()) + 1;
                        $('#ticketadded').val(ticketadded);
                        // totalitem = totalitem + 1;
                        if (Price && parseFloat(Price) > 0) {
                            AddTickeToCart(ticketId, 1, Price, paymentType, TicketName, AvQty);
                        }
                    }


            }
            else {

                if (parseInt(AvQty) > 0 && $('#ticketadded').val()>0) {
                    var ticketadded = parseInt($('#ticketadded').val()) - 1;
                    $('#ticketadded').val(ticketadded);
                    if (Price && parseFloat(Price) > 0) {
                       // totalamount = totalamount - parseFloat(Price);
                        AddTickeToCart(ticketId, -1, Price, paymentType, TicketName, AvQty);
                    }
                   // $("#spnsingle" + ticketId).text(AddedQty);
                }
            }
        } else {
            $('.error-box p').text('Please select the ticket');

        }

    }

    function AddMinusTicketNewq(type, ticketId, AvQty, Price, paymentType, TicketName,Sn) {
        debugger;
        TicketName = $('#TicketName_' + Sn).text();
        TicketStatic = '#TiktName_' + Sn;
        console.log('TicketCount:' + $(TicketStatic).val());
        console.log('TicketName :' + $('#TicketName_' + Sn).text());
        if (type != undefined && type != "" && ticketId != undefined && ticketId != "" && AvQty != undefined && AvQty != "NaN" && Price != undefined && paymentType != undefined) {

            if (type == "add") {

                if (parseInt(AvQty) > 0) {
                    var ticketadded = parseInt($(TicketStatic).val()) + 1;
                    $(TicketStatic).val(ticketadded);
                    // totalitem = totalitem + 1;
                    if (Price && parseFloat(Price) > 0) {
                        AddTickeToCart(ticketId, 1, Price, paymentType, TicketName, AvQty);
                        $.ajax({
                            url: '/ev/AddTickets',
                            contentType: 'application/html; charset=utf-8',
                            type: 'GET',
                            dataType: 'html',
                            success: function (result) {
                                Loader(false);

                                $('#label1').html(result);

                            },
                            error: function (xhr, status) {
                                Loader(false);
                                alert(status);
                            }
                        })
                    }
                }


            }
            else {

                if (parseInt(AvQty) > 0 && $(TicketStatic).val() > 0) {
                    var ticketadded = parseInt($(TicketStatic).val()) - 1;
                    $(TicketStatic).val(ticketadded);
                    if (Price && parseFloat(Price) > 0) {
                        // totalamount = totalamount - parseFloat(Price);
                        AddTickeToCart(ticketId, -1, Price, paymentType, TicketName, AvQty);
                        $.ajax({
                            url: '/ev/AddTickets',
                            contentType: 'application/html; charset=utf-8',
                            type: 'GET',
                            dataType: 'html',
                            success: function (result) {
                                Loader(false);

                                $('#label1').html(result);

                            },
                            error: function (xhr, status) {
                                Loader(false);
                                alert(status);
                            }
                        })
                    }
                    // $("#spnsingle" + ticketId).text(AddedQty);
                }
            }
        } else {
            $('.error-box p').text('Please select the ticket');

        }

    }

    function CheckAllRequriedField() {
        $('input.sn-required').each(function () {
            cntrl = $(this);
            if (cntrl.val().toString().length == 0) {
                if (!cntrl.hasClass('sn-error'))
                    cntrl.addClass('sn-error');
            }
            else {
                if (cntrl.hasClass('sn-error')) cntrl.removeClass('sn-error');
            }
        });
    }

    $('#fdiscount').click(function () {
        CheckAllRequriedField();

        if (document.getElementById('flexCheckDefault').checked == false) {
            $('.error-box p').text('Please select the checkbox to proceed!!');
            return
        } else {
            $('.error-box p').text('');
        }

            var FirstName = $('#FirstName').val();
            var LastName = $('#LastName').val();
            var EmailAddress = $('#EmailAddress').val();
            var MobileNumber = $('#MobileNumber').val();
            var UserId = $('#UserId').val();

            console.log("MobileNUmber :"+MobileNumber);

            $.ajax({
                url: "/ev/CheckAndCreateNewUserId",
                type: "POST",
                dataType: "json",
                contentType: "application/json; charset=utf-8",
                data: JSON.stringify({ FirstName: FirstName, LastName: LastName, EmailAddress: EmailAddress, MobileNumber: MobileNumber, UserId: UserId }),
                success: function (result) {
                    console.log(result.Id);
                    if (result.Code == 200) {
                        var hfeventId = $('#hfeventId').val();
                        var UserID = result.Id;
                        window.location.href = "@Url.Action("PaymentMode", "ev")?hfeventId=" + hfeventId + "&UserID=" + UserID;
                        //$.ajax({
                        //    url: "/ev/PaymentMode?hfeventId=" + hfeventId + "&UserID=" + UserID,
                        //    type: "GET",
                        //    dataType: "json",
                        //    contentType: "application/json; charset=utf-8",
                        //   // data: JSON.stringify({ FirstName: FirstName, LastName: LastName, EmailAddress: EmailAddress, MobileNumber: MobileNumber, UserId: UserId }),
                        //    success: function (result) {
                        //        console.log();
                        //    },
                        //    error: function (err) {
                        //        // check the err for error details
                        //    }
                        //}); // ajax call closing
                    }

                    },
                error: function (err) {
                    // check the err for error details
                }
            }); // ajax call closing

        });


    $(document).on("click", "#applycoupan", function () {
        debugger;
        var coupan = $('#Coupancode').val();
        var eventId = $("#eventid").val();
        $.ajax({
            type: 'POST',
            url: '/Payment/checkOffers?coupan=' + coupan + '&eventId=' + eventId,
            contentType: "application/json; charset=utf-8",
            dataType: "json",
            success: function (resp) {
                    LoadCart(eventId,"", coupan);
            },
            error: function (error) {
            }
        });
    });





</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script>
    function RemoveTicket(TicketId) {

          $.ajax({
                    type: 'POST',
                    url: '@Url.Action("RemoveTicket", "ev", new { area = "" })',
                    data: { TicketId: TicketId},
                    dataType: "json",
                    success: function (resp) {
                        debugger;
                        //if ($('.total-amount"').val() == 0) {
                        //    $('#hide').show();
                        //}
                        //if (resp.result.Code == 200) {
                            reload();
                       // }
                    },
                    error: function (error) {

                        alertify.alert(error);
                    }
                });
    }
</script>
<script type="text/javascript">
    function Loader(_value) {
        if (_value) {
            document.getElementById("divloader").style.display = "block";
        }
        else {
            document.getElementById("divloader").style.display = "none";
        }
        setTimeout(function () { document.getElementById("divloader").style.display = "none"; }, 360000);
    }
</script>

<div class="overlay" id="divloader" style="display:none">
    <div class="a" style="--n: 5;position: absolute;top: 50%;left: 50%;">
        <div class="dot" style="--i: 0;"></div>
        <div class="dot" style="--i: 1;"></div>
        <div class="dot" style="--i: 2;"></div>
        <div class="dot" style="--i: 3;"></div>
        <div class="dot" style="--i: 4;"></div>
    </div>
</div>