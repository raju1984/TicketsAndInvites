@{
    ViewBag.Title = "Verify OTP";
    Layout = "~/Views/Shared/_Layout.cshtml";
    <style>
        /*.rbutton{
            background-color:#f48534;
        }*/
        .card {
            background: #000;
            border-color: #313131;
            border-bottom: 1px solid #313131 !important;
        }

        p.alertify-message {
            color: #000;
        }

        .text-center {
            text-align: center !important;
            padding: 0 20px;
        }

        label {
            display: inline-block;
            margin-bottom: .5rem;
            color: #fff;
            font-size: 16px;
        }

        .card-header {
            border-bottom-color: #313131;
            color: #fff;
        }

        .btn-payment {
            margin-left: 40px;
            margin-top: 10px;
        }

        .smal-btn {
            border: #fff solid 1px !important;
            color: #fff !important;
            border-radius: 10px;
        }

        .smal-btn2 {
            border: #fff solid 2px !important;
            color: #fff !important;
            border-radius: 10px;
        }

        .card-body h4, h6, p {
            color: #fff;
        }

        .bold-text {
            font-size: 20px;
            font-weight: 600;
            color: #fff !important;
        }



        .card a:hover {
            color: #f86d08 !important;
        }
        /*.smal-btn:hover {
            background: #fb0000 !important;
            color: #fff !important;
            border: none;
        }*/
        .minheight {
            min-height: 300px;
        }

        .tab-content > .active {
            display: block;
            margin-top: 100px;
            text-align: center;
            margin-left: 0px;
        }

        .form-control {
            height: 35px;
            padding-left: 20px;
        }

        .form-group {
            margin-bottom: 10px !important;
        }

        b {
            font-weight: bolder;
            font-size: 21px;
        }

        .list-group {
            flex-direction: row;
        }

        .form-check-label {
            margin-bottom: 0;
            font-size: 16px;
        }


        .mt-5, .my-5 {
            margin-top: 7rem !important;
        }

        .list-group-item-action {
            width: auto;
        }

        .rbutton {
            background: #f48534 !important;
            text-align: center;
            /*padding: 5px 20%;*/
            width: 100%;
            margin-top: 20px;
            color: #fff !important;
        }
    </style>
}
@{
    <div class="container-fluid bgContainer">
        <div class="row ">
            <div class="container">
                <div class="row mt-5 " style="text-align:center">

                    <div class="col-md-4"></div>
                    <div class="col-md-4 bg-white pt-3">
                        <div class="card borderonTicket">
                            <input type="hidden" id="offerid" />
                            <div class="arc top-12 right-12"></div>
                            <div class="arc top-12 left-12"></div>
                            <div class="arc bottom-12 right-12"></div>
                            <div class="arc bottom-12 left-12"></div>
                            <img src="aa"
                                 class="card-img-top" alt="...">
                            <div class="card-body text-justify">
                                @using (Html.BeginForm("VerifyOTP", "Account", FormMethod.Post))
                                {
                                    <input type="hidden" value="@ViewBag.returnUrl" name="returnUrl" />
                                    <div class="otp">
                                        <h4 class="text-center">Verify OTP </h4>
                                        <br />
                                        @if (ViewBag.Phone != null)
                                        {
                                            <span style="color:white">Enter Confirmation code sent to your contact below :</span> <br /><span style="color:white">+</span><span style="color:white">@ViewBag.Code</span> <span style="color:white">@ViewBag.Phone</span>

                                        }
                                        else if (ViewBag.Email != null)
                                        {
                                            <span style="color:white">Enter Confirmation code sent to your contact below :</span> <br /><span style="color:white">@ViewBag.Email</span>
                                        }
                                        <br />
                                        <br />
                                        <div class="form-group">
                                            @*<label for="exampleInput">Enter Confirmation code sent to your phone</label>*@
                                            <input type="text" class="form-control" id="OTP" name="OTP" placeholder="Confirmation Code">
                                        </div>
                                        @*<div class="form-group">
                    <label for="exampleInput">Kindly enter your email if you wish to receive email notifications in addition to text messages</label>
                    <input type="email" class="form-control" id="Email" name="Email" placeholder="Your email address">
                </div>*@
                                        <button type="submit" class="btn btn-danger rbutton">Confirm</button>

                                    </div>
                                }
                                <button type="submit" id="btnAnotherNumber" class="btn btn-warning rbutton">Use Another Mobile Number or Email ID</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    @section Scripts
{
        <script>

        //$(document).ready(function () {
        //    function disablePrev() { window.history.forward() }
        //    window.onload = disablePrev();
        //    window.onpageshow = function (evt) { if (evt.persisted) disableBack() }
        //});
        $('#btnAnotherNumber').click(function () {
            window.location.href = '/Account/Userlogin';
        })
        $('#Login').click(function () {
        debugger;
        var userid = $('#Email').val();
        var password = $('#Password').val();
        if (userid == '' || userid == null) { $('#Emailerr').css("display", "block"); return false; }
        else { $('#Emailerr').css("display", "none");}
        if (password == '' || userid == null) { $('#Passworderr').css("display", "block"); return false;}
        else { $('#Passworderr').css("display", "none"); }
        var loginmodel = [];
        var data = {
            Email: userid,
            Password: password,
        }
        loginmodel.push(data);
            var returnUrl = "@ViewBag.returnUrl";

            //var logindata = JSON.stringify(loginmodel)
        $.ajax({
                type: 'POST',
                url: '@Url.Action("Login", "Account")',
            data: '{model: ' + JSON.stringify(data) + ', returnUrl: ' + JSON.stringify(returnUrl) + '}', //{ model: logindata, returnUrl: returnUrl },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (resp) {
                    debugger;
                    if (resp.result.Code == 200) {
                        location.reload();
                    }
                    else { alertify.alert(resp.result.Msg);}

                },
                error: function (error) {

                    alertify.alert(error);
                }
            });
            });
            $('#applycoupan').click(function () {
            debugger;
                var coupan = $('#Coupancode').val();
                var total = $('#lbltotal').text();
                var offeri = $("#offerid").val();
                if (offeri == '' || offeri == null) {
        $.ajax({
                type: 'POST',
                url: '@Url.Action("checkOffers", "Payment")',
                data: '{coupan: ' + JSON.stringify(coupan) +'}', //{ model: logindata, returnUrl: returnUrl },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (resp) {
                    debugger;
                    var discount;
                    var totalamount;
                    if (resp != null) {
                        if (resp[0].Offertype == 1) {
                            discount = total * resp[0].discount / 100;
                            totalamount = total - discount;
                        }
                        else if (resp[0].Offertype == 2) { discount = resp[0].discount; totalamount = total - resp[0].discount; }
                        $("#lbltotal").text(totalamount.toFixed(2));
                        $("#discount").text(discount.toFixed(2));
                        $("#offerid").val(resp[0].Id);
                    if (totalamount == 0) {
                        $("#fpay").css("display", "none");
                        $("#fdiscount").css("display", "block");
                        }
                    }
                    else { alertify.alert("Invalid Coupan");}

                },
                error: function (error) {

                    alertify.alert("Invalid Coupan");
                }
                    });
                }
            });
        $('input:radio[name=sex]:checked').val();
        function isValidEmailAddress(emailAddress) {
        var pattern = new RegExp(/^(("[\w-\s]+")|([\w-]+(?:\.[\w-]+)*)|("[\w-\s]+")([\w-]+(?:\.[\w-]+)*))(@@((?:[\w-]+\.)*\w[\w-]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@@\[?((25[0-5]\.|2[0-4][0-9]\.|1[0-9]{2}\.|[0-9]{1,2}\.))((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){2}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\]?$)/i);
        return pattern.test(emailAddress);
            };

        $('#walletPayy').click(function () {
        debugger;
            var EventId = "@(Request.QueryString["EventId"])";
            var walletno = $("#walletnumber").val();
           // var uuid = $("#UUID").val();
            //var logindata = JSON.stringify(loginmodel)
        $.ajax({
                type: 'POST',
            url: '@Url.Action("summeryPay", "Payment")',
            data: '{eventId: ' + JSON.stringify(EventId) + ', Mob: ' + JSON.stringify(walletno) +'}', //{ model: logindata, returnUrl: returnUrl },
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (resp) {
                    debugger;
                    if (resp.result.Code == 200) {

                        location.reload();
                    }
                    else { alert(resp.result.Msg);}

                },
                error: function (error) {

                    alert(error);
                }
            });
            });
        </script>}
}
<script src="~/js/jquery.js"></script>
<script src="../../js/alertify.js"></script>
@if (ViewBag.Msg != null)
{
    <script type="text/javascript">
            $(document).ready(function () {
                debugger
                alertify.alert("@ViewBag.Msg");
            })

    </script>
}


