@model EventManager1.Models.RegisterOrganization
@{
    Layout = null;
    ViewBag.Title = "OrganizerRegister";
    //Layout = "~/Views/Shared/_Layout.cshtml";
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="~/images/fav.png" type="image/gif">
    <link rel="stylesheet" href="~/vendors/iconfonts/mdi/css/materialdesignicons.min.css">
    <link rel="stylesheet" href="~/vendors/css/vendor.bundle.base.css">
    <link rel="stylesheet" href="~/css/style.css">
    <link rel="stylesheet" href="~/css/custom.css">
    <link href="~/css/alertify.core.css" rel="stylesheet" />
    <link href="~/css/alertify.default.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/css/bootstrap-select.min.css" />
    <style>
        .form-control {
            padding: 0.275rem 1.175rem !important;
        }

        .bootstrap-select.form-control-lg .dropdown-toggle {
            padding: 0 !important;
        }

        input[type=number]::-webkit-inner-spin-button,
        input[type=number]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
            margin: 0;
        }

        button.btn.dropdown-toggle.btn-light {
            background: none;
            border: none;
        }

        .filter-option-inner {
            width: 100%;
            height: 30px;
        }

        .bgimg {
            background-image: url(../images/bg.png);
            background-size: cover;
            background-repeat: no-repeat;
        }

        .bootstrap-select.form-control-lg .dropdown-toggle {
            padding: 0.4rem 1rem;
        }

        .error {
            color: red;
            visibility: hidden;
            padding: 8PX 5PX 0PX 15PX;
        }

        .displaynone {
            color: red;
            display: none;
            padding: 8PX 5PX 0PX 15PX;
        }

        .content-wrapper {
            background: transparent;
            padding: 0;
        }

        .auth .brand-logo {
            margin-bottom: 10px;
        }

        .auth .auth-form-light {
            border-radius: 25px;
        }

        .auth form .form-group .form-control,
        select.form-control {
            border-radius: 20px;
            border-color: #ccc;
            border: 1px solid;
            outline: none;
            color: #495057;
        }

        .auth form .auth-form-btn,
        .btn-Round {
            border-radius: 30px;
        }

        .w-75 {
            width: 75%;
        }

        .auth form .form-group {
            margin-bottom: .5rem;
        }

        .overlay {
            position: fixed;
            background: #4646462b;
            left: 0;
            right: 0;
            top: 0;
            bottom: 0;
            z-index: 100;
        }

        .dot {
            background: tomato;
        }

            .dot, .dot:after {
                display: inline-block;
                width: 2em;
                height: 2em;
                border-radius: 50%;
                animation: a 1.5s calc(((var(--i) + var(--o, 0))/var(--n) - 1)*1.5s) infinite;
            }

                .dot:after {
                    --o: 1;
                    background: currentcolor;
                    content: '';
                }

        @@keyframes a {
            0%, 50% {
                transform: scale(0);
            }
        }
    </style>
    <script type="text/javascript">
        function Loader(_value) {
            if (_value) {
                document.getElementById("divloader").style.display = "block";
            }
            else {
                document.getElementById("divloader").style.display = "none";
            }
            setTimeout(function () { document.getElementById("divloader").style.display = "none"; }, 30000);
        }
    </script>
}

<div class="container-scroller bgimg">
    <div class="container-fluid page-body-wrapper full-page-wrapper">
        <div class="content-wrapper d-flex align-items-center auth">
            <div class="row w-100" style="margin:20px 0">
                <div class="col-lg-4 mx-auto">
                    <div class="auth-form-light text-left p-5">
                        <div class="brand-logo">
                            <!-- <img src="../../images/logo.svg"> -->
                            <span class="d-inline-block">
                                <a href="/"
                                   class="btn btn-inverse-primary btn-rounded btn-icon icon-center" style="float: left;">                                   
                                    @*<img src="~/images/fav.png" />*@
                                    <i class="mdi mdi-arrow-left-drop-circle-outline "></i>
                                </a>
                                <b style="margin-top: 6px;display: inline-block; margin-left: 10px;">
                                    Stream233
                                </b>
                            </span>
                           
                        </div>
                        <h4>New here?</h4>
                        <h6 class="font-weight-light">Signing up is easy. It only takes a few steps</h6>
                        <form class="pt-3">
                            <p>Business Owner Details</p>
                            <table class="mycontainer" id="mainrow">
                                <tr>
                                    <td>
                                        <div class="form-group">
                                            <div class="input-group">
                                                <input type="text" aria-label="First name" placeholder="First Name" id="FirstName"
                                                       class="form-control FirstName">
                                                <input type="text" aria-label="Last name" placeholder="Last Name" id="LastName"
                                                       class="form-control LastName">
                                                <div class="displaynone col-md-12" id="FirstNameerr">First name is required</div>
                                            </div>
                                        </div>
                                        <div class="form-group">
                                            <input type="number" class="form-control form-control-lg PhoneNo" id="PhoneNo"
                                                   placeholder="Phone number" inputmode="numeric" >
                                            <div class="displaynone col-md-12" id="PhoneNoerr">Enter a valid mobile number</div>
                                        </div>
                                        <input type="button" id="add" value="Add More Business Partners" class="btn btn-gradient-danger btn-sm" />
                                    </td>
                                </tr>
                            </table>
                            <br />
                            <div id="orderItems">
                                <table class="table table-responsive" id="orderdetailsItems"></table>
                                <span id="orderItemError" style="color:red"></span>
                            </div>
                            <p>Business Details</p>
                            <div class="form-group" style="padding:0 !important">
                                @if (ViewBag.country != null)
                                {
                                    <select name="CountryId" id="CountryId" class="selectpicker form-control form-control-lg" data-show-subtext="false" data-live-search="true" onchange="OnEventChange(this)">

                                        @{

                                            foreach (var item in ViewBag.country)
                                            {

                                                if (ViewBag.countryId == item.Id)
                                                {
                                                    <option value="@item.Id" selected>@item.Name</option>
                                                }
                                                else
                                                {
                                                    <option value="@item.Id">@item.Name</option>
                                                }


                                            }

                                        }
                                    </select>
                                    @*@Html.DropDownList("Id", new SelectList(ViewBag.country, "Id", "Name"), new { @id = "CountryId", @class = "form-control form-control-lg" })*@
                                }
                                @*<select class="form-control form-control-lg" id="CountryId">
                                        <option>Country</option>
                                        <option value="3">United States of America</option>
                                        <option value="4">United Kingdom</option>
                                        <option value="5">India</option>
                                        <option value="6">Germany</option>
                                        <option value="7">Argentina</option>
                                    </select>*@
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control form-control-lg" id="City"
                                       placeholder="City">
                                @*<select class="form-control form-control-lg" id="City">
                                        <option>City</option>
                                        <option value="1">New York</option>
                                        <option value="2">Delhi</option>
                                    </select>*@
                            </div>

                            <div class="form-group">
                                <input type="text" class="form-control form-control-lg" id="Address"
                                       placeholder="Address">
                            </div>
                            <div class="form-group">
                                <input type="text" class="form-control form-control-lg" id="ZipCode"
                                       placeholder="Zip Code">
                            </div>
                            @*<div class="form-group">
                                    <input type="text" class="form-control form-control-lg" id="UserName"
                                           placeholder="User Name">
                                </div>*@

                            <div class="form-group">
                                <input type="email" required class="form-control form-control-lg" id="Email"
                                       placeholder="Email">
                                <div class="displaynone" id="errEmail">Email is required</div> <div class="displaynone" id="errEmail1">Email-id is invalid</div>
                            </div>

                            <div class="form-group">
                                <input type="text" class="form-control form-control-lg" id="BusinessName"
                                       placeholder="Business Name">
                                <div class="displaynone" id="BusinessNameerr">BusinessName is required</div>

                            </div>
                            <div class="form-group">
                                <input type="number" class="form-control form-control-lg" id="ContactNo" inputmode="numeric"
                                       placeholder="Contact number">
                                <div class="displaynone" id="ContactNoerr">Enter a valid Contact number</div>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-control form-control-lg"
                                       id="Password" placeholder="Password">
                                <div class="displaynone" id="Passworderr">Password is required</div>
                            </div>
                            <div class="form-group">
                                <input type="password" class="form-control form-control-lg"
                                       id="confPassword" placeholder="Confirm Password">
                                <div class="displaynone" id="confPassworderr">Password and confirm password does not match</div>
                            </div>
                            <div class="mb-4">
                                <div class="form-check">
                                    <label class="form-check-label text-muted">
                                        <input type="checkbox" class="form-check-input" id="chkTerm" checked="checked" style="opacity: 1; display:none; height:21px">

                                    </label>  &nbsp; &nbsp;  &nbsp; I agree to all <a href="~/Home/Terms" target="_blank"> Terms & Conditions </a>
                                </div>
                            </div>
                            <div class="mt-3">
                                <input id="submit" type="button" value="Create" class="btn btn-block btn-gradient-primary btn-lg font-weight-medium auth-form-btn" />
                                @*<a class="btn btn-block btn-gradient-primary btn-lg font-weight-medium auth-form-btn"
                                    href="organizer/dashboard.html">SIGN UP</a>*@
                            </div>
                            <div class="text-center mt-4 font-weight-light">
                                Already have an account? <a href="@Url.Action("OrganizerLogin","Account")" class="text-primary">Login</a>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- content-wrapper ends -->
    </div>
    <!-- page-body-wrapper ends -->
</div>
<div class="overlay" id="divloader" style="display:none">
    <div class="a" style="--n: 5;position: absolute;top: 50%;left: 50%;">
        <div class="dot" style="--i: 0;"></div>
        <div class="dot" style="--i: 1;"></div>
        <div class="dot" style="--i: 2;"></div>
        <div class="dot" style="--i: 3;"></div>
        <div class="dot" style="--i: 4;"></div>
    </div>
</div>
@*@section Scripts
    {*@
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
<script src="../../js/alertify.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"
        integrity="sha256-VazP97ZCwtekAsvgPBSUwPFKdrwD3unUfSGVYrahUqU="
        crossorigin="anonymous"></script>
<link href="~/css/JqueryUI.css" rel="stylesheet" />

<script src="../../vendors/js/vendor.bundle.base.js"></script>
<script src="../../vendors/js/vendor.bundle.addons.js"></script>
<!-- endinject -->
<!-- Plugin js for this page-->
<!-- End plugin js for this page-->
<!-- inject:js -->
<script src="../../js/off-canvas.js"></script>
<script src="../../js/misc.js"></script>
<!-- endinject -->
<!-- Custom js for this page-->
<script src="../../js/dashboard.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.9/dist/js/bootstrap-select.min.js"></script>
<script src="~/js/alertify.js"></script>
<script>
    $(function () {
        $('#CountryId').selectpicker();
    });
    $('#add').click(function () {
        debugger;
        //validation and add order items
        var isAllValid = true;
        if (!($('#FirstName').val().trim() != '')) {
            $('#FirstNameerr').css('display', 'block');
            allvalid = false;
        }
        else { $('#FirstNameerr').css('display', 'none'); }
        if (!($('#PhoneNo').val().trim() != '' && !isNaN($('#PhoneNo').val().trim()))) {
            isAllValid = false;
            $('#PhoneNoerr').css('display', 'block');
        }
        else {
            $('#PhoneNoerr').css('display', 'none');
        }
        
        if (isAllValid) {
            var $newRow = $('#mainrow').clone().removeAttr('id');
            //Replace add button with remove button
            $('#add', $newRow).addClass('remove').val('Remove').removeClass('btn-success').addClass('btn-danger');

            //remove id attribute from new clone row
            $('#FirstName,#LastName,#PhoneNo', $newRow).removeAttr('id');
            $('span.error', $newRow).remove();
            //append clone row
            $('#orderdetailsItems').append($newRow);                //clear select data
            $('#FirstName,#LastName,#PhoneNo').val('');
        }
    })

    //remove button click event
    $('#orderdetailsItems').on('click', '.remove', function () {
        $(this).parents('tr').remove();
    });
    $('#submit').click(function () {

        if ($("#chkTerm").prop('checked') == false) {
            alertify.alert("Please check the box of Terms & Conditions to continue.")
            return false;
        }
        var isAllValid = true;
        var list = [];

        var owner = {
            FirstName: $('#FirstName').val(),
            LastName: $('#LastName').val(),
            PhoneNo: $('#PhoneNo').val()
        }
        if (owner) {
            list.push(owner);
        }
        $('#orderdetailsItems tbody tr').each(function (index, ele) {
            var orderItem = {
                FirstName: $('.FirstName', this).val(),
                LastName: $('.LastName', this).val(),
                PhoneNo: $('.PhoneNo', this).val()
            }
            list.push(orderItem);
        })
        isAllValid = checkerror();
        debugger;
        if (isAllValid) {
            Loader(true);
            var Register = {
                //UserName: $('#UserName').val(),
                ContactNo: $('#ContactNo').val(),
                Email: $('#Email').val(),
                Password: $('#Password').val(),
                BusinessName: $('#BusinessName').val(),
                CountryId: $('#CountryId').val(),
                City: $('#City').val(),
                Address: $('#Address').val(),
                ZipCode: $('#ZipCode').val(),
                compOwners: list
            }
            //$(this).val('Please wait...');

            $.ajax({
                type: 'POST',
                url: '@Url.Action("OrganizerRegister", "Account")',
                data: '{Register: ' + JSON.stringify(Register) + '}',/* JSON.stringify(Register),*/
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                success: function (resp) {
                    debugger;
                    if (resp.result.Code == 200) {
                       // alertify.alert('Registration  Successfull ');
                        //here we will clear the form
                        list = [];
                        $('#UserName,#ContactNo,#Email,#Password,#BusinessName,#CountryId,#Address,#ZipCode,#LastName,#FirstName,#PhoneNo,#confPassword').val('');
                        $('#orderdetailsItems').empty();
                        Loader(false);
                        window.location.replace("/Account/OrganizerLogin");
                    }
                    else {

                        Loader(false);
                        alertify.alert(resp.result.Msg);
                    }
                },
                error: function (error) {
                    Loader(false);
                    console.log(error);
                }
            });
        }
        else { alertify.alert("@EventManager1.Resource.ResourceStrings.allfieldrequired");}
    });
    function checkerror() {
        var count = 0;
        //if (!($('#FirstName').val().trim() != '')) {
        //    $('#FirstNameerr').css('display', 'block');
        //    allvalid = false;
        //}
        //else { $('#FirstNameerr').css('display', 'none');}
        //if (!($('#PhoneNo').val().trim() != '' )) {
        //    $('#PhoneNoerr').css('display', 'block');
        //    allvalid = false;
        //}
        //else {
        //    $('#PhoneNoerr').css('display', 'block');
        //}
        if (!($('#FirstName').val().trim() != '')) {
            $('#FirstNameerr').css('display', 'block');
            allvalid = false;
        }
        else { $('#FirstNameerr').css('display', 'none'); }
        var mnum = $('#PhoneNo').val().length;
        var cnum = $('#ContactNo').val().length;
        if ($('#Email').val().trim() == '') {
            $('#errEmail').css('display', 'block');
            count++;
        }
        else if (IsEmail($('#Email').val()) == false) {
            $('#errEmail1').css('display', 'block');
            count++;}
        else {
            $('#errEmail').css('display', 'none');
            $('#errEmail1').css('display', 'none');
        }
        if ($('#ContactNo').val().trim() == '') {
            $('#ContactNoerr').css('display', 'block');
            count++;
        }
        else {
            $('#ContactNoerr').css('display', 'none');
        }
        if (!(cnum < 11)) {
            $('#ContactNoerr').css('display', 'block');
            count++;
        }
        else {
            $('#ContactNoerr').css('display', 'none');
        }
        if (!(mnum < 11)) {
            $('#PhoneNoerr').css('display', 'block');
            count++;          
        }
        else {
            $('#PhoneNoerr').css('display', 'none');
        }
        

        if ($('#BusinessName').val().trim() == '') {
            $('#BusinessNameerr').css('display', 'block');
            count++;
        }
        else {
            $('#BusinessNameerr').css('display', 'none');
        }
        if ($('#Password').val().trim() == '') {
            $('#Passworderr').css('display', 'block');
            count++;
        }
        else {
            $('#Passworderr').css('display', 'none');
        }
        if (!($('#confPassword').val().trim() == $('#Password').val().trim())) {
            $('#confPassworderr').css('display', 'block');
            count++;
        }
        else {
            $('#confPassworderr').css('display', 'none');
        }

        //if ($('#ContactNo').val().trim() == '') {
        //    $('#ContactNo').siblings('span.error').css('visibility', 'visible');
        //    allvalid = false;
        //}
        //else {
        //    $('#ContactNo').siblings('span.error').css('visibility', 'hidden');
        //}
        debugger;
        if (count==0) {
            return true;
        }
        else { return false; };
        
    }
    function IsEmail(email) {
        debugger;
        var regex = /^([a-zA-Z0-9_\.\-\+])+\@@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;
        if(!regex.test(email)) {
          return false;
        }else{
    return true;
        }

}
    @*function isValidEmailAddress(emailAddress) {
    var pattern = /^([a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+(\.[a-z\d!#$%&'*+\-\/=?^_`{|}~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)*|"((([ \t]*\r\n)?[ \t]+)?([\x01-\x08\x0b\x0c\x0e-\x1f\x7f\x21\x23-\x5b\x5d-\x7e\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|\\[\x01-\x09\x0b\x0c\x0d-\x7f\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))*(([ \t]*\r\n)?[ \t]+)?")@(([a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\d\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.)+([a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]|[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF][a-z\d\-._~\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]*[a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])\.?$/i;
    return pattern.test(emailAddress);*@

</script>


